csv.headers :id, :resource_id, :resource_type, :name, :title,
            :email, :department

csv.rows Contact.find_each do |csv, contact|
  contact.resource_contacts.each do |rc|
    csv.cells :id
    csv.cell :resource_id, rc.resource_id
    csv.cell :resource_type, rc.resource_type
    csv.cells :name, :title, :email, :department
  end

  if contact.resource_contacts.blank?
    csv.cells :id, :name, :title, :email, :department
  end
end
